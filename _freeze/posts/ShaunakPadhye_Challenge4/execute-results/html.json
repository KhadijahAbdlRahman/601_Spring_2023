{
  "hash": "d9f09f0f8f4aad848ecc68d15a3d0f43",
  "result": {
    "markdown": "---\ntitle: \"Challenge 4\"\nauthor: \"Shaunak Padhye\"\ndescription: \"More data wrangling: pivoting\"\ndate: \"05/13/2023\"\nformat:\n  html:\n    toc: true\n    code-fold: true\n    code-copy: true\n    code-tools: true\ncategories:\n  - challenge_4\n  - Shaunak Padhye\n  - hotel_bookings\n---\n\n\n## Setup\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\"}\nlibrary(tidyverse)\nlibrary(lubridate)\n\nknitr::opts_chunk$set(echo = TRUE, warning=FALSE, message=FALSE)\n```\n:::\n\n\n## Challenge Overview\n\nToday's challenge is to:\n\n1)  read in a data set, and describe the data set using both words and any supporting information (e.g., tables, etc)\n2)  tidy data (as needed, including sanity checks)\n3)  identify variables that need to be mutated\n4)  mutate variables and sanity check all mutations\n\n## Read in data\n\nWe will be using the following dataset for this challenge:\n\n-   hotel_bookings.csv⭐⭐⭐⭐\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbookings <- read.csv(\"_data/hotel_bookings.csv\")\nhead(bookings)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n         hotel is_canceled lead_time arrival_date_year arrival_date_month\n1 Resort Hotel           0       342              2015               July\n2 Resort Hotel           0       737              2015               July\n3 Resort Hotel           0         7              2015               July\n4 Resort Hotel           0        13              2015               July\n5 Resort Hotel           0        14              2015               July\n6 Resort Hotel           0        14              2015               July\n  arrival_date_week_number arrival_date_day_of_month stays_in_weekend_nights\n1                       27                         1                       0\n2                       27                         1                       0\n3                       27                         1                       0\n4                       27                         1                       0\n5                       27                         1                       0\n6                       27                         1                       0\n  stays_in_week_nights adults children babies meal country market_segment\n1                    0      2        0      0   BB     PRT         Direct\n2                    0      2        0      0   BB     PRT         Direct\n3                    1      1        0      0   BB     GBR         Direct\n4                    1      1        0      0   BB     GBR      Corporate\n5                    2      2        0      0   BB     GBR      Online TA\n6                    2      2        0      0   BB     GBR      Online TA\n  distribution_channel is_repeated_guest previous_cancellations\n1               Direct                 0                      0\n2               Direct                 0                      0\n3               Direct                 0                      0\n4            Corporate                 0                      0\n5                TA/TO                 0                      0\n6                TA/TO                 0                      0\n  previous_bookings_not_canceled reserved_room_type assigned_room_type\n1                              0                  C                  C\n2                              0                  C                  C\n3                              0                  A                  C\n4                              0                  A                  A\n5                              0                  A                  A\n6                              0                  A                  A\n  booking_changes deposit_type agent company days_in_waiting_list customer_type\n1               3   No Deposit  NULL    NULL                    0     Transient\n2               4   No Deposit  NULL    NULL                    0     Transient\n3               0   No Deposit  NULL    NULL                    0     Transient\n4               0   No Deposit   304    NULL                    0     Transient\n5               0   No Deposit   240    NULL                    0     Transient\n6               0   No Deposit   240    NULL                    0     Transient\n  adr required_car_parking_spaces total_of_special_requests reservation_status\n1   0                           0                         0          Check-Out\n2   0                           0                         0          Check-Out\n3  75                           0                         0          Check-Out\n4  75                           0                         0          Check-Out\n5  98                           0                         1          Check-Out\n6  98                           0                         1          Check-Out\n  reservation_status_date\n1              2015-07-01\n2              2015-07-01\n3              2015-07-02\n4              2015-07-02\n5              2015-07-03\n6              2015-07-03\n```\n:::\n:::\n\n\n### Briefly describe the data\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndim(bookings)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 119390     32\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncolnames(bookings)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] \"hotel\"                          \"is_canceled\"                   \n [3] \"lead_time\"                      \"arrival_date_year\"             \n [5] \"arrival_date_month\"             \"arrival_date_week_number\"      \n [7] \"arrival_date_day_of_month\"      \"stays_in_weekend_nights\"       \n [9] \"stays_in_week_nights\"           \"adults\"                        \n[11] \"children\"                       \"babies\"                        \n[13] \"meal\"                           \"country\"                       \n[15] \"market_segment\"                 \"distribution_channel\"          \n[17] \"is_repeated_guest\"              \"previous_cancellations\"        \n[19] \"previous_bookings_not_canceled\" \"reserved_room_type\"            \n[21] \"assigned_room_type\"             \"booking_changes\"               \n[23] \"deposit_type\"                   \"agent\"                         \n[25] \"company\"                        \"days_in_waiting_list\"          \n[27] \"customer_type\"                  \"adr\"                           \n[29] \"required_car_parking_spaces\"    \"total_of_special_requests\"     \n[31] \"reservation_status\"             \"reservation_status_date\"       \n```\n:::\n:::\n\nThis dataset contains the booking details for a number of hotels. This is a very comprehensive dataset having 32 variables. It covers various details such as the details of the booking party (adults, children, babies, meal, country, etc), details of the hotel(hotel, reserved room type, assigned room type, etc) and details of the booking itself(arrival date details, reservation status details, etc).\n\n## Tidy Data (as needed)\n\nWe can do some simple checks to see if the dataset is tidy. Lets check if there are any duplicate rows or null values in the dataset\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\"}\nprint(anyDuplicated(bookings) == 0)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] FALSE\n```\n:::\n\n```{.r .cell-code  code-fold=\"false\"}\nprint(sum(is.na(bookings)) == 0)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] FALSE\n```\n:::\n:::\n\n\nWe can see that there are no duplicate rows or null rows. The dataset is tidy.\n\n## Identify variables that need to be mutated\n\nWe can see that the arrival details have been split into 4 columns:\n\n::: {.cell}\n\n```{.r .cell-code}\ngrep(\"arrival\",names(bookings), value = TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"arrival_date_year\"         \"arrival_date_month\"       \n[3] \"arrival_date_week_number\"  \"arrival_date_day_of_month\"\n```\n:::\n:::\n\n\n\nInstead we can convert this into a single variable which will hold the arrival date in a standard format. In this case we will convert it to the same format as \"reservation_status_date\" variable (YYYY-MM-DD).\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbookings$date_str <- paste(bookings$arrival_date_year, bookings$arrival_date_month, bookings$arrival_date_day_of_month, sep = \"-\")\n\nbookings$arrival_date <- as.Date(bookings$date_str, format = \"%Y-%B-%d\")\n\nbookings <- bookings[, !(names(bookings) %in% \"date_str\")]\n\nhead(select(bookings, arrival_date, reservation_status_date))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  arrival_date reservation_status_date\n1   2015-07-01              2015-07-01\n2   2015-07-01              2015-07-01\n3   2015-07-01              2015-07-02\n4   2015-07-01              2015-07-02\n5   2015-07-01              2015-07-03\n6   2015-07-01              2015-07-03\n```\n:::\n:::\n\n\nNow we can remove the original 4 arrival variables:\n\n::: {.cell}\n\n```{.r .cell-code}\nbookings <- select(bookings, -arrival_date_year, -arrival_date_month, -arrival_date_week_number, -arrival_date_day_of_month)\ncolnames(bookings)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] \"hotel\"                          \"is_canceled\"                   \n [3] \"lead_time\"                      \"stays_in_weekend_nights\"       \n [5] \"stays_in_week_nights\"           \"adults\"                        \n [7] \"children\"                       \"babies\"                        \n [9] \"meal\"                           \"country\"                       \n[11] \"market_segment\"                 \"distribution_channel\"          \n[13] \"is_repeated_guest\"              \"previous_cancellations\"        \n[15] \"previous_bookings_not_canceled\" \"reserved_room_type\"            \n[17] \"assigned_room_type\"             \"booking_changes\"               \n[19] \"deposit_type\"                   \"agent\"                         \n[21] \"company\"                        \"days_in_waiting_list\"          \n[23] \"customer_type\"                  \"adr\"                           \n[25] \"required_car_parking_spaces\"    \"total_of_special_requests\"     \n[27] \"reservation_status\"             \"reservation_status_date\"       \n[29] \"arrival_date\"                  \n```\n:::\n:::\n\nThe lead_time variable tells us the number of days between the reservation date and the arrival date. Therefore, using the lead_time variable, we can add a variable to store the day the reservation was made.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbookings$reservation_booking_date <- bookings$arrival_date - days(bookings$lead_time)\nhead(select(bookings, lead_time, arrival_date, reservation_booking_date))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  lead_time arrival_date reservation_booking_date\n1       342   2015-07-01               2014-07-24\n2       737   2015-07-01               2013-06-24\n3         7   2015-07-01               2015-06-24\n4        13   2015-07-01               2015-06-18\n5        14   2015-07-01               2015-06-17\n6        14   2015-07-01               2015-06-17\n```\n:::\n:::\n\n\nWe can look at the final dataset after the mutations:\n\n::: {.cell}\n\n```{.r .cell-code}\ncolnames(bookings)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] \"hotel\"                          \"is_canceled\"                   \n [3] \"lead_time\"                      \"stays_in_weekend_nights\"       \n [5] \"stays_in_week_nights\"           \"adults\"                        \n [7] \"children\"                       \"babies\"                        \n [9] \"meal\"                           \"country\"                       \n[11] \"market_segment\"                 \"distribution_channel\"          \n[13] \"is_repeated_guest\"              \"previous_cancellations\"        \n[15] \"previous_bookings_not_canceled\" \"reserved_room_type\"            \n[17] \"assigned_room_type\"             \"booking_changes\"               \n[19] \"deposit_type\"                   \"agent\"                         \n[21] \"company\"                        \"days_in_waiting_list\"          \n[23] \"customer_type\"                  \"adr\"                           \n[25] \"required_car_parking_spaces\"    \"total_of_special_requests\"     \n[27] \"reservation_status\"             \"reservation_status_date\"       \n[29] \"arrival_date\"                   \"reservation_booking_date\"      \n```\n:::\n:::\n\n\nWith this our dataset has been mutated to a more convenient format for further analysis.\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}