{
  "hash": "7aff412f9d6231dd300670fa66cce309",
  "result": {
    "markdown": "---\ntitle: \"Final Project\"\nauthor: \"Maanusri Balasubramanian\"\ndescription: \"Analysing World Population\"\ndate: \"05/18/2023\"\nformat:\n  html:\n    toc: true\n    code-copy: true\n    code-tools: true\ncategories:\n  - final project\n  - world population\n  - maanusri balasubramanian\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(here)\nlibrary(viridis)\nlibrary(wordcloud)\nlibrary(wordcloud2)\nlibrary(scales)\nlibrary(tidyr)\nlibrary(ggplot2)\nlibrary(treemap)\nlibrary(knitr)\nlibrary(treemapify)\n\nknitr::opts_chunk$set(echo = TRUE)\n```\n:::\n\n\n## Introduction\n\nThis dataset contains information of the world population over the years (from 1970 to 2022) for every country/territory.\n\nEach entry in the table contains attributes of a specific county/territory, including a 3 digit country/territory code, name of the continent in belongs to, name of the capital, area (in square kilometers), population density (per square kilometer), population growth rate, ranking based on population and the world population percentage.\n\nWith this project I plan to:\n\n1. Conduct an exploratory analysis of the dataset to uncover intriguing patterns and gain deeper insights into the global population and its evolutionary trends.\n\n2. Visualize the identified patterns to delve into the finer details and gain a comprehensive understanding of sub-patterns.\n\n## Reading the data\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Reading the data from world_population.csv\nworld_population <- here(\"posts\",\"MaanusriBalasubramanian_FinalProjectData\",\"world_population.csv\") %>% read_csv()\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nRows: 234 Columns: 17\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr  (4): CCA3, Country/Territory, Capital, Continent\ndbl (13): Rank, 2022 Population, 2020 Population, 2015 Population, 2010 Popu...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n:::\n:::\n\n\nOn reading the data, we see that it is tidy and doesn't need extra work, so we move on to understand the data further.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Reading the latitude and longitude information of different countries\nworld_loc <- map_data('world')\n```\n:::\n\n\nI also loaded the world map data, which contains the latitude and longitude information of each country/territory. I'm planning to use this in world map visualizations to see if there are trends/patterns based on location.\n\n## Getting to know the dataset\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# peaking into the dataset\nhead(world_population)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 17\n   Rank CCA3  `Country/Territory` Capital          Continent `2022 Population`\n  <dbl> <chr> <chr>               <chr>            <chr>                 <dbl>\n1    36 AFG   Afghanistan         Kabul            Asia               41128771\n2   138 ALB   Albania             Tirana           Europe              2842321\n3    34 DZA   Algeria             Algiers          Africa             44903225\n4   213 ASM   American Samoa      Pago Pago        Oceania               44273\n5   203 AND   Andorra             Andorra la Vella Europe                79824\n6    42 AGO   Angola              Luanda           Africa             35588987\n# ℹ 11 more variables: `2020 Population` <dbl>, `2015 Population` <dbl>,\n#   `2010 Population` <dbl>, `2000 Population` <dbl>, `1990 Population` <dbl>,\n#   `1980 Population` <dbl>, `1970 Population` <dbl>, `Area (km²)` <dbl>,\n#   `Density (per km²)` <dbl>, `Growth Rate` <dbl>,\n#   `World Population Percentage` <dbl>\n```\n:::\n\n```{.r .cell-code}\n# number of rows\nnrow(world_population)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 234\n```\n:::\n\n```{.r .cell-code}\n# number of columns\nncol(world_population)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 17\n```\n:::\n\n```{.r .cell-code}\n# column names in the dataset\ncolnames(world_population)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] \"Rank\"                        \"CCA3\"                       \n [3] \"Country/Territory\"           \"Capital\"                    \n [5] \"Continent\"                   \"2022 Population\"            \n [7] \"2020 Population\"             \"2015 Population\"            \n [9] \"2010 Population\"             \"2000 Population\"            \n[11] \"1990 Population\"             \"1980 Population\"            \n[13] \"1970 Population\"             \"Area (km²)\"                 \n[15] \"Density (per km²)\"           \"Growth Rate\"                \n[17] \"World Population Percentage\"\n```\n:::\n\n```{.r .cell-code}\n# peaking into the map data\nhead(world_loc)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n       long      lat group order region subregion\n1 -69.89912 12.45200     1     1  Aruba      <NA>\n2 -69.89571 12.42300     1     2  Aruba      <NA>\n3 -69.94219 12.43853     1     3  Aruba      <NA>\n4 -70.00415 12.50049     1     4  Aruba      <NA>\n5 -70.06612 12.54697     1     5  Aruba      <NA>\n6 -70.05088 12.59707     1     6  Aruba      <NA>\n```\n:::\n:::\n\n\nWe can see that the world population dataset has 234 rows and 17 columns. Information about 234 unique countries/territories is present in this table. We can also see that the world\n_loc dataset has all the needed location information about the countries and territories. We can notice that these two datasets can be merged based on the region column in world_loc and the Country/Territory column in world_population.\n\n## Summarizing the data\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Summarizing the world population data\nsummary(world_population)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n      Rank            CCA3           Country/Territory    Capital         \n Min.   :  1.00   Length:234         Length:234         Length:234        \n 1st Qu.: 59.25   Class :character   Class :character   Class :character  \n Median :117.50   Mode  :character   Mode  :character   Mode  :character  \n Mean   :117.50                                                           \n 3rd Qu.:175.75                                                           \n Max.   :234.00                                                           \n  Continent         2022 Population     2020 Population     2015 Population    \n Length:234         Min.   :5.100e+02   Min.   :5.200e+02   Min.   :5.640e+02  \n Class :character   1st Qu.:4.197e+05   1st Qu.:4.153e+05   1st Qu.:4.047e+05  \n Mode  :character   Median :5.560e+06   Median :5.493e+06   Median :5.307e+06  \n                    Mean   :3.407e+07   Mean   :3.350e+07   Mean   :3.173e+07  \n                    3rd Qu.:2.248e+07   3rd Qu.:2.145e+07   3rd Qu.:1.973e+07  \n                    Max.   :1.426e+09   Max.   :1.425e+09   Max.   :1.394e+09  \n 2010 Population     2000 Population     1990 Population    \n Min.   :5.960e+02   Min.   :6.510e+02   Min.   :7.000e+02  \n 1st Qu.:3.931e+05   1st Qu.:3.272e+05   1st Qu.:2.641e+05  \n Median :4.943e+06   Median :4.293e+06   Median :3.825e+06  \n Mean   :2.985e+07   Mean   :2.627e+07   Mean   :2.271e+07  \n 3rd Qu.:1.916e+07   3rd Qu.:1.576e+07   3rd Qu.:1.187e+07  \n Max.   :1.348e+09   Max.   :1.264e+09   Max.   :1.154e+09  \n 1980 Population     1970 Population       Area (km²)       Density (per km²)  \n Min.   :      733   Min.   :      752   Min.   :       1   Min.   :    0.026  \n 1st Qu.:   229614   1st Qu.:   155997   1st Qu.:    2650   1st Qu.:   38.418  \n Median :  3141146   Median :  2604830   Median :   81200   Median :   95.347  \n Mean   : 18984617   Mean   : 15786909   Mean   :  581449   Mean   :  452.127  \n 3rd Qu.:  9826054   3rd Qu.:  8817329   3rd Qu.:  430426   3rd Qu.:  238.933  \n Max.   :982372466   Max.   :822534450   Max.   :17098242   Max.   :23172.267  \n  Growth Rate    World Population Percentage\n Min.   :0.912   Min.   : 0.0000            \n 1st Qu.:1.002   1st Qu.: 0.0100            \n Median :1.008   Median : 0.0700            \n Mean   :1.010   Mean   : 0.4271            \n 3rd Qu.:1.017   3rd Qu.: 0.2800            \n Max.   :1.069   Max.   :17.8800            \n```\n:::\n\n```{.r .cell-code}\n# Summarizing the map data\nsummary(world_loc)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n      long              lat              group            order       \n Min.   :-180.00   Min.   :-85.192   Min.   :   1.0   Min.   :     1  \n 1st Qu.: -67.86   1st Qu.:  1.795   1st Qu.: 381.0   1st Qu.: 25215  \n Median :  16.59   Median : 32.467   Median : 823.0   Median : 50492  \n Mean   :  10.52   Mean   : 24.969   Mean   : 801.3   Mean   : 50470  \n 3rd Qu.:  78.95   3rd Qu.: 54.029   3rd Qu.:1243.0   3rd Qu.: 75746  \n Max.   : 190.27   Max.   : 83.600   Max.   :1627.0   Max.   :100964  \n    region           subregion        \n Length:99338       Length:99338      \n Class :character   Class :character  \n Mode  :character   Mode  :character  \n                                      \n                                      \n                                      \n```\n:::\n:::\n\n\nAfter summarizing the dataset, I've decided to choose these variables for further analysis:\n\nCountry/Territory - Name of the place under consideration\n\nContinent - Name of the continent in which the place is located\n\n2022 Population - Population of the place in the year 2022\n\n2020 Population - Population of the place in the year 2020\n\n2015 Population - Population of the place in the year 2015\n\n2010 Population - Population of the place in the year 2010\n\n2000 Population - Population of the place in the year 2000\n\n1990 Population - Population of the place in the year 1990\n\n1980 Population - Population of the place in the year 1980\n\n1970 Population - Population of the place in the year 1970\n\nDensity (per km²) - Country/Territory's population density\n\nGrowth Rate - Country/Territory's population growth rate\n\n## Understanding variables of the dataset\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# printing the number of continents on which we have information\nlength(unique(world_population$Continent))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 6\n```\n:::\n\n```{.r .cell-code}\n# printing the mean global population over the years\nmean(world_population$`2022 Population`)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 34074415\n```\n:::\n\n```{.r .cell-code}\nmean(world_population$`2020 Population`)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 33501071\n```\n:::\n\n```{.r .cell-code}\nmean(world_population$`2015 Population`)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 31729956\n```\n:::\n\n```{.r .cell-code}\nmean(world_population$`2010 Population`)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 29845235\n```\n:::\n\n```{.r .cell-code}\nmean(world_population$`2000 Population`)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 26269469\n```\n:::\n\n```{.r .cell-code}\nmean(world_population$`1990 Population`)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 22710221\n```\n:::\n\n```{.r .cell-code}\nmean(world_population$`1980 Population`)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 18984617\n```\n:::\n\n```{.r .cell-code}\nmean(world_population$`1970 Population`)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 15786909\n```\n:::\n:::\n\n\nWe see that the dataset contains information about countries/territories in 6 continents. We can also see that the mean world population has been steadily increasing over the years.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# printing the countries that are the most and least populous in 2022\nworld_population[which.max(world_population$`2022 Population`), \"Country/Territory\"]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1 × 1\n  `Country/Territory`\n  <chr>              \n1 China              \n```\n:::\n\n```{.r .cell-code}\nworld_population[which.min(world_population$`2022 Population`), \"Country/Territory\"]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1 × 1\n  `Country/Territory`\n  <chr>              \n1 Vatican City       \n```\n:::\n\n```{.r .cell-code}\n# printing the countries with the highest and lowest population densities\nworld_population[which.max(world_population$`Density (per km²)`), \"Country/Territory\"]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1 × 1\n  `Country/Territory`\n  <chr>              \n1 Macau              \n```\n:::\n\n```{.r .cell-code}\nworld_population[which.min(world_population$`Density (per km²)`), \"Country/Territory\"]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1 × 1\n  `Country/Territory`\n  <chr>              \n1 Greenland          \n```\n:::\n:::\n\n\nAs of 2022, China is the most populous country in the world and Vatican city is the least populous. We can also see that Macau has the highest population density, i.e. the number of people in a given unit of area (if population was to be evenly distributed) is the highest here. And Greenland has the least population density.\n\nDue to the large area of China, it is understandable that even though China is the most populous country, its population density isn't the highest.\n\n## Data Cleaning & Mutation\n \n\n::: {.cell}\n\n```{.r .cell-code}\n# changing column names\ncolnames(world_population) <- c(\"rank\", \"cca3\", \"country\", \"capital\", \"continent\", \"2022\", \"2020\", \"2015\", \"2010\", \"2000\", \"1990\", \"1980\", \"1970\", \"area\", \"density\", \"growth_rate\", \"world_pop_perc\")\n\nhead(world_population)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 17\n   rank cca3  country       capital continent `2022` `2020` `2015` `2010` `2000`\n  <dbl> <chr> <chr>         <chr>   <chr>      <dbl>  <dbl>  <dbl>  <dbl>  <dbl>\n1    36 AFG   Afghanistan   Kabul   Asia      4.11e7 3.90e7 3.38e7 2.82e7 1.95e7\n2   138 ALB   Albania       Tirana  Europe    2.84e6 2.87e6 2.88e6 2.91e6 3.18e6\n3    34 DZA   Algeria       Algiers Africa    4.49e7 4.35e7 3.95e7 3.59e7 3.08e7\n4   213 ASM   American Sam… Pago P… Oceania   4.43e4 4.62e4 5.14e4 5.48e4 5.82e4\n5   203 AND   Andorra       Andorr… Europe    7.98e4 7.77e4 7.17e4 7.15e4 6.61e4\n6    42 AGO   Angola        Luanda  Africa    3.56e7 3.34e7 2.81e7 2.34e7 1.64e7\n# ℹ 7 more variables: `1990` <dbl>, `1980` <dbl>, `1970` <dbl>, area <dbl>,\n#   density <dbl>, growth_rate <dbl>, world_pop_perc <dbl>\n```\n:::\n:::\n\n\nI renamed the columns in the dataset for easier processing and understanding. Looking into the dataset, we can see that there aren't any noticeable number of NA values in the table. So there isn't much cleaning to be done in the dataset.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# merging the world_population and map data \nmap_data <- world_loc %>% inner_join(world_population, by = c(\"region\" = \"country\"))\nhead(map_data)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n       long      lat group order region subregion rank cca3    capital\n1 -69.89912 12.45200     1     1  Aruba      <NA>  198  ABW Oranjestad\n2 -69.89571 12.42300     1     2  Aruba      <NA>  198  ABW Oranjestad\n3 -69.94219 12.43853     1     3  Aruba      <NA>  198  ABW Oranjestad\n4 -70.00415 12.50049     1     4  Aruba      <NA>  198  ABW Oranjestad\n5 -70.06612 12.54697     1     5  Aruba      <NA>  198  ABW Oranjestad\n6 -70.05088 12.59707     1     6  Aruba      <NA>  198  ABW Oranjestad\n      continent   2022   2020   2015   2010  2000  1990  1980  1970 area\n1 North America 106445 106585 104257 100341 89101 65712 62267 59106  180\n2 North America 106445 106585 104257 100341 89101 65712 62267 59106  180\n3 North America 106445 106585 104257 100341 89101 65712 62267 59106  180\n4 North America 106445 106585 104257 100341 89101 65712 62267 59106  180\n5 North America 106445 106585 104257 100341 89101 65712 62267 59106  180\n6 North America 106445 106585 104257 100341 89101 65712 62267 59106  180\n   density growth_rate world_pop_perc\n1 591.3611      0.9991              0\n2 591.3611      0.9991              0\n3 591.3611      0.9991              0\n4 591.3611      0.9991              0\n5 591.3611      0.9991              0\n6 591.3611      0.9991              0\n```\n:::\n:::\n\n\nMerging the world_loc and world map data to get location and population information at one place together. This location specific information is now stored in a separate dataset as 'map_data'.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# mutating the population in 2022 for better representation on the world map\nmap_data <- map_data %>% mutate(curr_pop = round(`2022` / 1000000, 2))\n```\n:::\n\n\n### Potential research questions\n\n1. Which country is the most populated?\n\n2. How is the world population changing over the years (increasing/decreasing)?\n\n3. What are the most populous countries?\n\n4. Is there a trend in population over the continents?\n\n5. Is the population of a continent impacted by the number of countries in it?\n\n6. Is there any trend in population over countries geographically?\n\n7. Are the country size and population density connected in any way?\n\n8. How is the population growing/shrinking over the years in each continent? Are there some continents in which the growth is more than in others?\n\n9. Any possibility of the most populous continent to change over the next decade?\n\n10. Are there any possibilities for change in the order of most populous countries soon?\n\n## Visualising the world population over the years\n\nTo start off, I want to understand how/rate at which the mean world population has been varying over the years. To do this, we need to plot the mean world population over the years.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# calculate means\ny <- c(\n  mean(world_population$`1970`),\n  mean(world_population$`1980`),\n  mean(world_population$`1990`),\n  mean(world_population$`2000`),\n  mean(world_population$`2010`),\n  mean(world_population$`2020`)\n)\n\n# labels for the x-axis (years)\nx <- c(\"1970\", \"1980\", \"1990\", \"2000\", \"2010\", \"2020\")\n\n# assign names to y-values\nnames(y) <- x\n\n# plotting the trend\npar(cex.axis = 0.8, mar = c(5, 5, 2, 2))\n\nplot(y, xaxt = \"n\", xlab = \"Year\", ylab = \"Mean World Population\", col = \"steelblue\", pch = 19, xlim = c(1, 6))\naxis(1, at = 1:6, labels = names(y))\ntitle(main = \"Mean world population over the years\", cex.main = 1.2)\n```\n\n::: {.cell-output-display}\n![](final_project_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n\nFrom the above visualization (plot of mean world population for every 10 years), we can see that the trend has been linear. And that the population has been steadily increasing over the decades. \n\n## Population by region/place\n\nLet's visualize the population of some of the most populous countries or territories in a bar chart. \n\nFirst we need to find the top 20 most populous countries. So we order the entries in world population in descending order of the region population and extract the top 20 entries.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# ordering the countries based on their population (in the descending order)\nmost_populous <- world_population[order(world_population$`2022`, decreasing = TRUE),]\ntop_20 <- most_populous[1:20,]\n\n# formatting the population values for displaying in the graph\ntop_20$pop_format <- sub(\"\\\\.00$\", \"\", sub(\"(\\\\d)(?=(\\\\d{3})+$)\", \"\\\\1,\", format(top_20$`2022`, big.mark = \",\", scientific = FALSE, trim = TRUE), perl = TRUE), perl = TRUE)\n```\n:::\n\n\nI've also reformatted the population with commas in the right places, to make the values more readable in the graph.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# bar chart showing top 20 countries with the highest  populations (2022)\nggplot(top_20, aes(x = reorder(country, -`2022`), y = `2022`, fill = country)) +\n  geom_bar(stat = \"identity\") +\n  labs(x = \"Country\", y = \"Population\") +\n  theme(axis.text.x = element_text(angle = 90, hjust = 1)) +\n  scale_y_continuous(labels = scales::comma) +\n  geom_text(aes(label = pop_format), angle = 90, vjust = -0.25, color = \"black\", size = 3.5) +\n  theme(legend.position = \"none\")\n```\n\n::: {.cell-output-display}\n![](final_project_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n:::\n\n\nFrom this bar plot we can see that China and India are the most populous countries, they also have a high margin of difference over the countries that follow. United States, Indonesia, Pakistan, Nigeria and many more follow these. \n\n## Population by Continent\n\nNext, I want to visualize how the world's population is distributed across the different continents. \n\n\n::: {.cell}\n\n```{.r .cell-code}\n# group by continent and sum populations\ncontinent_population <- aggregate(`2022` ~ continent, data = world_population, FUN = sum)\n\n# calculate proportions of the population by continent and multiply by 100\ncontinent_population$perc <- prop.table(continent_population$`2022`) * 100\n```\n:::\n\n\nFor this, I've aggregated the population data by continent, determined the population proportion for each specific continent, and then multiplied it by 100.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(continent_population, aes(continent, perc)) +\n  geom_col(width = .7) +\n  geom_text(aes(label = round(perc, 2)), size = 2.5, vjust = -1) +\n  labs(title = \"Population Distribution across Continents\",\n      x = \"Continent\", y = \"Population Proportion\") +\n  theme_minimal() +\n  theme(text = element_text(size = 9),\n      plot.title = element_text(size = 14), \n      panel.grid.major.x = element_blank(), panel.grid.minor.y = element_blank())\n```\n\n::: {.cell-output-display}\n![](final_project_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n:::\n\n\n## Number of Countries per Continent\n\nTo better understand the population distribution across continents, we first need to understand the number of countries in each continent. We can understand if the population proportion of a continent is attributed to the number of countries it has or to the population density, by getting an idea about the number of countries in each continent. \n\n\n::: {.cell}\n\n```{.r .cell-code}\n# calculating number of countries in each continent\nconti_country <- world_population %>%\n  group_by(continent) %>%\n  summarize(n_countries = n())\n```\n:::\n\n\nNow we can plot the number of countries in each continent in a bar chart to visualise this distribution.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = conti_country, aes(x = n_countries, y = continent, fill = continent)) +\n  geom_col() +\n  labs(x = \"Number of countries\", y = \"Continent\") +\n  theme(legend.position = \"none\") +\n  geom_text(aes(label = n_countries), hjust = 1.4, color = \"white\")\n```\n\n::: {.cell-output-display}\n![](final_project_files/figure-html/unnamed-chunk-17-1.png){width=672}\n:::\n:::\n\n\nWe can see that Africa has the highest number of countries but still holds only a small proportion of the world population. However, Asia holds a large proportion of the world population and also has a comparabale number of countries. We can also see that even though the proportion of population in Oceania is lesser than in South America, it has more number of countries than South America. So we can't say that the number of countries in a continent has an impact on the population of the continent.\n\n## Population on world map\n\nI'm trying to visualize the population by country on the world map to see if there are any trends in population based on the region.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = map_data) +\n  geom_polygon(aes(x = long, y = lat, group = group, fill = curr_pop)) +\n  coord_map(xlim = c(-180, 180)) +\n  scale_fill_viridis(trans = \"log\", name = \"Population\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Transformation introduced infinite values in discrete y-axis\n```\n:::\n\n::: {.cell-output-display}\n![](final_project_files/figure-html/unnamed-chunk-18-1.png){width=672}\n:::\n:::\n\n\nBased on the visualization, we can't see any specific trends across the map. However, we can note that the countries towards the north-eastern end of the map(China, India, Russia) are more populous.\n\n## Population density country-wise\n\nUnderstanding the population density distribution over countries can help us understand the criticality of population growth in a country.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# storing only the region and population density information in a dataframe\nword_data <- data.frame(text = world_population$country, size = world_population$density)\n\n# sorting the countries in the decreasing order of density\nword_data <- word_data[order(word_data$size, decreasing = TRUE), ]\n```\n:::\n\n\nVisualizing the population density in a tree map will give us a holistic visual comparison of the differences in the population densities of the countries.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntreemap(word_data, index = \"text\", vSize = \"size\",\n        title = \"Word Treemap\", fontsize.labels = 8,\n        palette = \"Pastel2\", border.col = \"white\", border.lw = 1,\n        align.entry = c(0, 0, 1, 1))\n```\n\n::: {.cell-output-display}\n![](final_project_files/figure-html/unnamed-chunk-20-1.png){width=672}\n:::\n:::\n\n\nFrom the visualization we can see that Macau and Monaco have high population densities. We can note that even though these are not too highly populous(like India or China), they are densely populous.\n\nWe can note that many of the small countries are densely populous from this visualization (even if they are not contributing heavily to the world population).\n\n## Continent-wise population growth over the years\n\nFirstly, I'm aggregating the yearly population data based on the continent.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# aggregating the yearly population based on the continent\nconti_country <- world_population %>%\n  group_by(continent) %>%\n  summarize(conti_2022 = sum(`2022`), conti_2020 = sum(`2020`), conti_2015 = sum(`2015`), conti_2010 = sum(`2010`), conti_2000 = sum(`2000`), conti_1990 = sum(`1990`), conti_1980 = sum(`1980`), conti_1970 = sum(`1970`))\n\nconti_country\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 9\n  continent    conti_2022 conti_2020 conti_2015 conti_2010 conti_2000 conti_1990\n  <chr>             <dbl>      <dbl>      <dbl>      <dbl>      <dbl>      <dbl>\n1 Africa       1426730932 1360671810 1201102442 1055228072  818946032  638150629\n2 Asia         4721383274 4663086535 4458250182 4220041327 3735089604 3210563577\n3 Europe        743147538  745792196  741535608  735613934  726093423  720320797\n4 North Ameri…  600296136  594236593  570383850  542720651  486069584  421266425\n5 Oceania        45038554   43933426   40403283   37102764   31222778   26743822\n6 South Ameri…  436816608  431530043  413134396  393078250  349634282  297146415\n# ℹ 2 more variables: conti_1980 <dbl>, conti_1970 <dbl>\n```\n:::\n:::\n\n\nPivoting the dataset to get continent-wise data in separate columns, for easier processing while plotting.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Converting into a suitable format for plotting\ntransposed_table <- as.data.frame(t(conti_country))\ncol_names <- c(\"Africa\", \"Asia\", \"Europe\", \"North America\", \"Oceania\", \"South America\")\ncolnames(transposed_table) <- col_names\ntransposed_table <- transposed_table[-1, ]\n\nx = c('2022', '2020', '2015', '2010', '2000', '1990', '1980', '1970')\n\ndata <- data.frame(x, \"Africa\" = as.numeric(transposed_table[[\"Africa\"]]), \n                   \"Asia\" = as.numeric(transposed_table[[\"Asia\"]]), \n                   \"NorthAmerica\" = as.numeric(transposed_table[[\"North America\"]]),\n                   \"Europe\" = as.numeric(transposed_table[[\"Europe\"]]),\n                   \"Oceania\" = as.numeric(transposed_table[[\"Oceania\"]]),\n                   \"SouthAmerica\" = as.numeric(transposed_table[[\"South America\"]])\n                   )\n\n# Reshape the data to a tidy format\ndata_tidy <- data %>% pivot_longer(-x, names_to = \"Continent\", values_to = \"Population\")\n```\n:::\n\n\nI'm plotting a line chart to better visualize the population trend over the years and using separate lines to represent the population of each continent.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data_tidy, aes(x = x, y = Population, color = Continent, group = Continent)) +\n  geom_line() +\n  labs(x = \"Year\", y = \"Population\", title = \"Population over the years\") +\n  scale_color_manual(values = c(\"Africa\" = \"black\", \"Asia\" = \"blue\", \n                                \"NorthAmerica\" = \"red\", \"Europe\" = \"green\", \"Oceania\" = \"orange\", \n                                \"SouthAmerica\" = \"purple\")) +\n  theme_minimal() +\n  theme(plot.title = element_text(size = 14),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        legend.title = element_blank(),\n        legend.text = element_text(size = 10))\n```\n\n::: {.cell-output-display}\n![](final_project_files/figure-html/unnamed-chunk-23-1.png){width=672}\n:::\n:::\n\n\nFrom this graph, we can see that the population in Oceania and Europe hasn't increased much/at all over the years. However, the population has been increasing exponentially in Africa and Asia (even more swiftly in the case of Asia).\n\n## Rate of population growth continent-wise\n\nLooking into the rate at which the population has been changing and the popluation at present, can help in understanding if the population dynamics across continents is about to change anytime soon.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# calculating growth rates over every decade and grouping by continent\nconti_grs <- world_population %>%\n  mutate(gr1970_1980 = (`1980` - `1970`) / `1970`,\n         gr1980_1990 = (`1990` - `1980`) / `1980`,\n         gr1990_2000 = (`2000` - `1990`) / `1990`,\n         gr2000_2010 = (`2010` - `2000`) / `2000`,\n         gr2010_2020 = (`2020` - `2010`) / `2010`) %>%\n  group_by(continent) %>%\n  summarize(gr1970_1980 = sum(gr1970_1980),\n            gr1980_1990 = sum(gr1980_1990),\n            gr1990_2000 = sum(gr1990_2000),\n            gr2000_2010 = sum(gr2000_2010),\n            gr2010_2020 = sum(gr2010_2020)\n            )\nconti_grs\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 6\n  continent     gr1970_1980 gr1980_1990 gr1990_2000 gr2000_2010 gr2010_2020\n  <chr>               <dbl>       <dbl>       <dbl>       <dbl>       <dbl>\n1 Africa              18.9        19.0        16.1        16.6        15.1 \n2 Asia                17.4        14.9        11.4        12.3         8.80\n3 Europe               4.75        3.09        1.26        1.38        1.22\n4 North America        7.88       10.5         5.96        4.78        3.46\n5 Oceania              4.63        5.84        3.72        1.20        1.74\n6 South America        2.91        3.07        2.78        1.82        1.72\n```\n:::\n:::\n\n\nPlotting the trend in population growth rates over the years in a line chart below. I'm also representing the growth rate in each continent with a separate line to make suitable comparisons.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# converting into a suitable format for plotting\ngrowth_rates <- as.data.frame(t(conti_grs))\ncol_names <- c(\"Africa\", \"Asia\", \"Europe\", \"North America\", \"Oceania\", \"South America\")\ncolnames(growth_rates) <- col_names\ngrowth_rates <- growth_rates[-1, ]\n\ngrowth_rates\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n               Africa      Asia    Europe North America   Oceania South America\ngr1970_1980 18.913276 17.432118  4.748693      7.878436  4.632448      2.912862\ngr1980_1990 19.024179 14.920304  3.093344     10.533882  5.844839      3.069779\ngr1990_2000 16.086291 11.377870  1.265000      5.962618  3.716717      2.776081\ngr2000_2010 16.600349 12.301519  1.384076      4.781042  1.198996      1.819007\ngr2010_2020 15.058021  8.799031  1.221328      3.459849  1.741768      1.722626\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# re-formatting the data for easier processing\nx = c('2010_2020', '2000_2010', '1990_2000', '1980_1990', '1970_1980')\n\ndata <- data.frame(x, \"Africa\" = as.numeric(growth_rates[[\"Africa\"]]), \n                   \"Asia\" = as.numeric(growth_rates[[\"Asia\"]]), \n                   \"NorthAmerica\" = as.numeric(growth_rates[[\"North America\"]]),\n                   \"Europe\" = as.numeric(growth_rates[[\"Europe\"]]),\n                   \"Oceania\" = as.numeric(growth_rates[[\"Oceania\"]]),\n                   \"SouthAmerica\" = as.numeric(growth_rates[[\"South America\"]])\n                   )\n\n# Reshape the data to a tidy format\ndata_tidy <- data %>% pivot_longer(-x, names_to = \"Continent\", values_to = \"Population\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data_tidy, aes(x = x, y = Population, color = Continent, group = Continent)) +\n  geom_line() +\n  labs(x = \"Year\", y = \"Population Growth Rate\", title = \"Population growth rate over the years\") +\n  scale_color_manual(values = c(\"Africa\" = \"black\", \"Asia\" = \"blue\", \n                                \"NorthAmerica\" = \"red\", \"Europe\" = \"green\", \"Oceania\" = \"orange\", \n                                \"SouthAmerica\" = \"purple\")) +\n  theme_minimal() +\n  theme(plot.title = element_text(size = 14),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        legend.title = element_blank(),\n        legend.text = element_text(size = 10))\n```\n\n::: {.cell-output-display}\n![](final_project_files/figure-html/unnamed-chunk-27-1.png){width=672}\n:::\n:::\n\n\nFrom the above visualization we can see the variation in the rate of population growth over the decades continent-wise. We can note that the population growth rate has been on a decrease over the last decade in North America.\n\nThe population growth rate has been almost constant for Africa over the decade, while that of Asia has been on a rise (coherent with the exponential increase in population). Overall, as the population growth rate of Asia is increasing and the population is already higher than the others, we can say that the probability that any other continent overtakes Asia anytime soon, is very low.\n\n## Rate of population growth in the topmost populous countries\n\nWe'll similarly observe this trend in the top populous countries.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# getting the top 5 populous countries\ntop_5 <- most_populous[1:5,]\n\ntop_5\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 5 × 17\n   rank cca3  country       capital continent `2022` `2020` `2015` `2010` `2000`\n  <dbl> <chr> <chr>         <chr>   <chr>      <dbl>  <dbl>  <dbl>  <dbl>  <dbl>\n1     1 CHN   China         Beijing Asia      1.43e9 1.42e9 1.39e9 1.35e9 1.26e9\n2     2 IND   India         New De… Asia      1.42e9 1.40e9 1.32e9 1.24e9 1.06e9\n3     3 USA   United States Washin… North Am… 3.38e8 3.36e8 3.25e8 3.11e8 2.82e8\n4     4 IDN   Indonesia     Jakarta Asia      2.76e8 2.72e8 2.59e8 2.44e8 2.14e8\n5     5 PAK   Pakistan      Islama… Asia      2.36e8 2.27e8 2.11e8 1.94e8 1.54e8\n# ℹ 7 more variables: `1990` <dbl>, `1980` <dbl>, `1970` <dbl>, area <dbl>,\n#   density <dbl>, growth_rate <dbl>, world_pop_perc <dbl>\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# calculating growth rates over every decade country-wise\n\ntop5_grs <- top_5 %>%\n  mutate(gr1970_1980 = (`1980` - `1970`) / `1970`,\n         gr1980_1990 = (`1990` - `1980`) / `1980`,\n         gr1990_2000 = (`2000` - `1990`) / `1990`,\n         gr2000_2010 = (`2010` - `2000`) / `2000`,\n         gr2010_2020 = (`2020` - `2010`) / `2010`) %>%\n  group_by(country) %>%\n  summarize(gr1970_1980, gr1980_1990, gr1990_2000, gr2000_2010, gr2010_2020)\n\ntop5_grs\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 5 × 6\n  country       gr1970_1980 gr1980_1990 gr1990_2000 gr2000_2010 gr2010_2020\n  <chr>               <dbl>       <dbl>       <dbl>       <dbl>       <dbl>\n1 China               0.194       0.174      0.0957      0.0665      0.0569\n2 India               0.250       0.249      0.217       0.171       0.126 \n3 Indonesia           0.286       0.229      0.175       0.140       0.114 \n4 Pakistan            0.360       0.432      0.338       0.260       0.168 \n5 United States       0.114       0.112      0.138       0.102       0.0796\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# converting into a suitable format for plotting\ngrs <- as.data.frame(t(top5_grs))\ncol_names <- c(\"China\", \"India\", \"Indonesia\", \"Pakistan\", \"United States\")\ncolnames(grs) <- col_names\ngrs <- grs[-1, ]\n\ngrs\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                 China      India  Indonesia   Pakistan United States\ngr1970_1980  0.1943238  0.2499135  0.2859426  0.3598056     0.1138714\ngr1980_1990  0.1744061  0.2491629  0.2293389  0.4315091     0.1117850\ngr1990_2000 0.09568728 0.21733705 0.17518977 0.33753125    0.13831952\ngr2000_2010  0.0665235  0.1707948  0.1398767  0.2596657     0.1019279\ngr2010_2020 0.05691953 0.12556166 0.11409816 0.16837997    0.07956466\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# re-formatting the data for easier processing\nx = c('2010_2020', '2000_2010', '1990_2000', '1980_1990', '1970_1980')\n\ndata <- data.frame(x, \"China\" = as.numeric(grs[[\"China\"]]), \n                   \"India\" = as.numeric(grs[[\"India\"]]), \n                   \"Indonesia\" = as.numeric(grs[[\"Indonesia\"]]),\n                   \"Pakistan\" = as.numeric(grs[[\"Pakistan\"]]),\n                   \"UnitedStates\" = as.numeric(grs[[\"United States\"]])\n                   )\n\n# Reshape the data to a tidy format\ndata_tidy <- data %>% pivot_longer(-x, names_to = \"Country\", values_to = \"Population\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data_tidy, aes(x = x, y = Population, color = Country, group = Country)) +\n  geom_line() +\n  labs(x = \"Year\", y = \"Population Growth Rate\", title = \"Population growth rate over the years\") +\n  scale_color_manual(values = c(\"China\" = \"black\", \"India\" = \"blue\", \n                                \"Indonesia\" = \"red\", \"Pakistan\" = \"green\", \"UnitedStates\" = \"orange\"\n                                )) +\n  theme_minimal() +\n  theme(plot.title = element_text(size = 16, face = \"bold\"),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10),\n        legend.title = element_blank(),\n        legend.text = element_text(size = 10))\n```\n\n::: {.cell-output-display}\n![](final_project_files/figure-html/unnamed-chunk-32-1.png){width=672}\n:::\n:::\n\n\nFrom this plot, we can see the changes in growth rates over the years in the most populous countries. Both China's and India's growth rate is on an increase, while rate of increase is higher for China. So we can't surely say anything about the trend change in the coming decade.\n\nTaking the case of Indonesia and the United States, while US's growth rate is lightly positive, Indonesia's growth rate is linearly increasing (population is exponentially increasing). Considering the difference in their respective populations, there is a possibilty for Indonesia to overtake the United States. Similarly, looking at the population growth rates and current populations of Pakistan and Indonesia, we can say that the probability of Pakistan overtaking Indonesia is minimal.\n\n## Conclusion\n\nFrom the analysis done above we were able to answer all of our research questions. We derived that China is the most populous as of 2022 and that the general world population has been on an increase over the decades.We also found that China, India, the United Staes, Indonesia and Pakistan are the most populous countries. \n\nThis study established that the population variation doesn't have anything to do with the geographical location of the countries/territories. And also that the number of constituent countries doesn't impact a continent population. We also implied observed that the countries of small sizes are more densily populated.\n\nFinally we also analysed the population growth and growth rates country-wise and continent-wise to predict if there will be any changes in the general trend over the next decade.\n\n## Bibliography\n\n[1] https://www.kaggle.com/datasets/iamsouravbanerjee/world-population-dataset\n[2] https://www.r-project.org/about.html",
    "supporting": [
      "final_project_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}