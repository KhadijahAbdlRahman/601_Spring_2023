{
  "hash": "1528f4e3fca4f6bbd81d7db997e35e5e",
  "result": {
    "markdown": "---\ntitle: \"Final Project: Kevin Martell Luya\"\nauthor: \"Kevin Martell Luya\"\ndescription: \"Project submission\"\ndate: \"05/31/2023\"\nformat:\n  html:\n    df-print: paged\n    toc: true\n    code-copy: true\n    code-tools: true\n    css: styles.css\ncategories:\n  - final_Project\neditor_options: \n  chunk_output_type: console\neditor: \n  markdown: \n    wrap: 72\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(ggplot2)\nlibrary(here)\nlibrary(mosaic)\nlibrary(tidyverse)\nlibrary(lubridate)\n\nknitr::opts_chunk$set(echo = TRUE, warning=FALSE, message=FALSE)\n```\n:::\n\n\n## Abstract {#abstract}\n\nSwimming has become a fundamental aspect of human culture and has been\npracticed for thousands of years. They provide a platform for physical\nactivity, competition, and entertainment. Swimming is one of the many\nsports that have gained popularity worldwide due to its many health\nbenefits and inclusion in major international events like the Olympic\nGames. Competitive swimming features a variety of events, including\nfreestyle, breaststroke, backstroke, and butterfly. The world records\nfor each event are continually being broken by exceptional world top\nathletes who push the limits of human performance medley, with races\nranging from 50 meters to 1500 meters. This paper will focus on the Top\n200 world times data set, which contains historical records of the best\n200 swimming times from 1980 to 2020, and answer the following research\nquestions.\n\n1\\. Are there any patterns or trends in the progression of swimming\nworld records over time? For example, are records being broken more\nfrequently during certain events or specific periods? Or Are world\nrecords more likely to be broken in shorter or longer races or specific\nstroke categories?\n\n2\\. Is there a relationship between a swimmer's age, gender, or\nnationality and their likelihood of breaking a world record? For\nexample, do younger or older swimmers tend to break records more often\nthan their peers?\n\n3\\. Have advancements in technology or changes in swimming equipment\nimpacted the frequency or magnitude of world record-breaking? For\nexample, have swimsuits or other equipment innovations led to more world\nrecords being broken in recent years?\n\n## Data set {#describe-the-data-sets}\n\nData.world is a platform for data collaboration, analysis, and sharing\ndesigned to help teams and organizations discover, use, and publish\nhigh-quality data in different contexts, such as competitive swimming.\nData has been centralized by this organization resulting in the Top 200\nworld times. In total, there are 5,200 instances and 14 columns. In this\ndata set, each row represents a different swim record. Each column\ncontains a specific piece of information such as the event names, swim\ntimes, swim date, event description, and athlete name, as well as\ninformation about the team they represent, their full name, gender,\nbirth date, rank order, duration of their swim and last but not the\nleast the city and country code where the event took place in the world.\nThe data is sourced from various international swimming competitions,\nincluding the Olympic Games, the FINA World Championships, and national\nchampionships in different countries.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# read in the swim data frame\ndf_swim<- read_csv(\"./_data/swimming_database.csv\")\n# look at the head of the data\nhead(df_swim)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"index\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Event Name\"],\"name\":[2],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"Swim time\"],\"name\":[3],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"Swim date\"],\"name\":[4],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"Event description\"],\"name\":[5],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"Team Code\"],\"name\":[6],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"Team Name\"],\"name\":[7],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"Athlete Full Name\"],\"name\":[8],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"Gender\"],\"name\":[9],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"Athlete birth date\"],\"name\":[10],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"Rank_Order\"],\"name\":[11],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"City\"],\"name\":[12],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"Country Code\"],\"name\":[13],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"Duration (hh:mm:ss:ff)\"],\"name\":[14],\"type\":[\"chr\"],\"align\":[\"left\"]}],\"data\":[{\"1\":\"0\",\"2\":\"European Championships 2022\",\"3\":\"46.86\",\"4\":\"08-13-22\",\"5\":\"Men 100 Freestyle LCM Male\",\"6\":\"ROU\",\"7\":\"Romania\",\"8\":\"POPOVICI, David\",\"9\":\"M\",\"10\":\"09-15-04\",\"11\":\"1\",\"12\":\"Rome\",\"13\":\"ITA\",\"14\":\"0:0:46:86\"},{\"1\":\"1\",\"2\":\"13th FINA World Championships 2009\",\"3\":\"46.91\",\"4\":\"07-30-09\",\"5\":\"Men 100 Freestyle LCM Male\",\"6\":\"BRA\",\"7\":\"Brazil\",\"8\":\"CIELO FILHO, Cesar\",\"9\":\"M\",\"10\":\"01-10-87\",\"11\":\"2\",\"12\":\"Rome\",\"13\":\"ITA\",\"14\":\"0:0:46:91\"},{\"1\":\"2\",\"2\":\"French National Championships (50m)\",\"3\":\"46.94\",\"4\":\"04-23-09\",\"5\":\"Men 100 Freestyle LCM Male\",\"6\":\"FRA\",\"7\":\"France\",\"8\":\"BERNARD, Alain\",\"9\":\"M\",\"10\":\"05-01-83\",\"11\":\"3\",\"12\":\"Montpellier\",\"13\":\"FRA\",\"14\":\"0:0:46:94\"},{\"1\":\"3\",\"2\":\"18th FINA World Championships 2019\",\"3\":\"46.96\",\"4\":\"07-25-19\",\"5\":\"Men 100 Freestyle LCM Male\",\"6\":\"USA\",\"7\":\"United States of America\",\"8\":\"DRESSEL, Caeleb\",\"9\":\"M\",\"10\":\"08-16-96\",\"11\":\"4\",\"12\":\"Gwangju\",\"13\":\"KOR\",\"14\":\"0:0:46:96\"},{\"1\":\"4\",\"2\":\"European Championships 2022\",\"3\":\"46.98\",\"4\":\"08-12-22\",\"5\":\"Men 100 Freestyle LCM Male\",\"6\":\"ROU\",\"7\":\"Romania\",\"8\":\"POPOVICI, David\",\"9\":\"M\",\"10\":\"09-15-04\",\"11\":\"5\",\"12\":\"Rome\",\"13\":\"ITA\",\"14\":\"0:0:46:98\"},{\"1\":\"5\",\"2\":\"Olympic Games Tokyo 2020\",\"3\":\"47.02\",\"4\":\"07-29-21\",\"5\":\"Men 100 Freestyle LCM Male\",\"6\":\"USA\",\"7\":\"United States of America\",\"8\":\"DRESSEL, Caeleb\",\"9\":\"M\",\"10\":\"08-16-96\",\"11\":\"6\",\"12\":\"Tokyo\",\"13\":\"JPN\",\"14\":\"0:0:47:02\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\nThis data set has records from 716 swimmers and 474 events worldwide\nfrom 1980 to 2020.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# dimensions of the data set\ndim(df_swim)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 5200   14\n```\n:::\n\n```{.r .cell-code}\n# number of unique Event name\nlength(unique(df_swim$`Event Name`))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 474\n```\n:::\n\n```{.r .cell-code}\n# number of unique Team name\nlength(unique(df_swim$`Team Name`))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 58\n```\n:::\n\n```{.r .cell-code}\n# number of unique Athletes\nlength(unique(df_swim$`Athlete Full Name`))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 716\n```\n:::\n\n```{.r .cell-code}\n# table of the 26 unique Swimming Events\ntable(df_swim$`Event description`)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n      Men 100 Backstroke LCM Male     Men 100 Breaststroke LCM Male \n                              200                               200 \n       Men 100 Butterfly LCM Male        Men 100 Freestyle LCM Male \n                              200                               200 \n      Men 1500 Freestyle LCM Male       Men 200 Backstroke LCM Male \n                              200                               200 \n    Men 200 Breaststroke LCM Male        Men 200 Butterfly LCM Male \n                              200                               200 \n       Men 200 Freestyle LCM Male           Men 200 Medley LCM Male \n                              200                               200 \n       Men 400 Freestyle LCM Male           Men 400 Medley LCM Male \n                              200                               200 \n       Men 800 Freestyle LCM Male   Women 100 Backstroke LCM Female \n                              200                               200 \nWomen 100 Breaststroke LCM Female    Women 100 Butterfly LCM Female \n                              200                               200 \n   Women 100 Freestyle LCM Female   Women 1500 Freestyle LCM Female \n                              200                               200 \n  Women 200 Backstroke LCM Female Women 200 Breaststroke LCM Female \n                              200                               200 \n   Women 200 Butterfly LCM Female    Women 200 Freestyle LCM Female \n                              200                               200 \n      Women 200 Medley LCM Female    Women 400 Freestyle LCM Female \n                              200                               200 \n      Women 400 Medley LCM Female    Women 800 Freestyle LCM Female \n                              200                               200 \n```\n:::\n:::\n\n\nBefore conducting a summary statistics of the data set, we need to\ncompute and store in a dedicated column 1) the swimmers' age when they\ncompeted at a given event in time and 2) the swimming event year when it\ntook place. Then, we will mutate the table and factor the columns. This\nprocess will facilitate and shorten the code implementation for the\nfollowing research questions.\n\nLet us extract the year from the Swim Date column.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# extract the event year\ndate <- parse_date_time(df_swim$`Swim date`, orders = \"mdy\")\n# concatenate the years as a new column\ndf_swim$event_year = year(date)\n```\n:::\n\n\nBecause there are swimmers that were born before 1968 and Libridate has\na difficult time parsing years before 1968 due to the \"Year 2000\nproblem,\" we created a function that add the century to the year: from\nthis \"dd-mm-yy\" to \"dd-mm-yyyy\" format.\n\nNow, let's extract the swimmers' age in the year of the competition\nusing add_century function.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# extract the athlete birth date year\ndate <- parse_date_time2(as.character(df_swim$`Athlete birth date`), \"mdy\", cutoff_2000 = 0)\n# concatenate the event_athle_age as a new column\ndf_swim$event_athle_age = df_swim$event_year -  year(date)\n```\n:::\n\n\nNow, let's factor the columns of interest and show the statistic of the\nvariables swim_time and event_athle_age.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf_swim <- df_swim %>%\n  mutate(\n    `Event Name` = factor(`Event Name`),\n    `Team Code` = factor(`Team Code`),\n    `Team Name` = factor(`Team Name`),\n    `Athlete Full Name` = factor(`Athlete Full Name`),\n    `Gender` = factor(`Gender`),\n    `Athlete birth date` = factor(`Athlete birth date`),\n    `Rank_Order` = factor(`Rank_Order`),\n    `City` = factor(`City`),\n    `Country Code` = factor(`Country Code`)\n  )\n\nsummary(df_swim)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n     index                                            Event Name  \n Min.   :   0   Olympic Games Tokyo 2020                   : 361  \n 1st Qu.:1300   13th FINA World Championships 2009         : 293  \n Median :2600   18th FINA World Championships 2019         : 228  \n Mean   :2600   Olympic Games Rio 2016                     : 228  \n 3rd Qu.:3899   19th FINA World Championships Budapest 2022: 226  \n Max.   :5199   17th FINA World Championships 2017         : 223  \n                (Other)                                    :3641  \n  Swim time          Swim date         Event description    Team Code   \n Length:5200        Length:5200        Length:5200        USA    :1360  \n Class :character   Class :character   Class :character   AUS    : 637  \n Mode  :character   Mode  :character   Mode  :character   JPN    : 427  \n                                                          CHN    : 377  \n                                                          GBR    : 314  \n                                                          HUN    : 287  \n                                                          (Other):1798  \n                      Team Name                Athlete Full Name Gender  \n United States of America  :1360   LEDECKY, Katie       : 218    F:2600  \n Australia                 : 637   HOSSZU, Katinka      : 129    M:2600  \n Japan                     : 427   PHELPS, Michael      :  86            \n People's Republic of China: 377   SJOESTROEM, Sarah    :  82            \n Great Britain             : 314   SUN, Yang            :  78            \n Hungary                   : 287   PALTRINIERI, Gregorio:  75            \n (Other)                   :1798   (Other)              :4532            \n Athlete birth date   Rank_Order               City       Country Code \n 03-17-97: 218      1      :  26   Tokyo         : 611   USA    : 710  \n 05-03-89: 129      2      :  26   Budapest      : 585   JPN    : 671  \n 05-24-94: 105      3      :  26   Rome          : 420   HUN    : 599  \n 06-30-85:  86      4      :  26   Rio de Janeiro: 234   ITA    : 497  \n 08-17-93:  82      5      :  26   Gwangju       : 230   CHN    : 439  \n 12-01-91:  78      6      :  26   (Other)       :3118   AUS    : 391  \n (Other) :4502      (Other):5044   NA's          :   2   (Other):1893  \n Duration (hh:mm:ss:ff)   event_year   event_athle_age\n Length:5200            Min.   :1980   Min.   : 14.0  \n Class :character       1st Qu.:2013   1st Qu.: 21.0  \n Mode  :character       Median :2017   Median : 24.0  \n                        Mean   :2016   Mean   : 32.4  \n                        3rd Qu.:2021   3rd Qu.: 26.0  \n                        Max.   :2022   Max.   :121.0  \n                                                      \n```\n:::\n\n```{.r .cell-code}\n# stats of Swim time \nfav_stats(df_swim$`Swim time`)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"min\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Q1\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"median\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Q3\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"max\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"mean\"],\"name\":[6],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"sd\"],\"name\":[7],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"n\"],\"name\":[8],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"missing\"],\"name\":[9],\"type\":[\"int\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"46.86\",\"2\":\"51.11\",\"3\":\"54.015\",\"4\":\"58.1325\",\"5\":\"59.01\",\"6\":\"54.0612\",\"7\":\"3.816413\",\"8\":\"1400\",\"9\":\"3800\",\"_rn_\":\"\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\n# stats of swimmer's age at time of competition\nfav_stats(df_swim$event_athle_age)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"min\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Q1\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"median\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Q3\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"max\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"mean\"],\"name\":[6],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"sd\"],\"name\":[7],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"n\"],\"name\":[8],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"missing\"],\"name\":[9],\"type\":[\"int\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"14\",\"2\":\"21\",\"3\":\"24\",\"4\":\"26\",\"5\":\"121\",\"6\":\"32.4025\",\"7\":\"28.27944\",\"8\":\"5200\",\"9\":\"0\",\"_rn_\":\"\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\nLet us take a quick view of each country's records from 1980 to 2022.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf_swim %>%\n  group_by(`Team Code`) %>%\n  summarise(record_counts = length(`Team Code`)) %>%\n  mutate(`Team Code` = fct_reorder(`Team Code`, record_counts)) %>%\n  ggplot() + geom_col(aes(record_counts, `Team Code`)) +\n  labs(title = \"Country record (1980 - 2022) \",\n       x = \"Number of records\", y =\"Country\")\n```\n\n::: {.cell-output-display}\n![](finalproject_KevinMartell_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\nWe can see that the dominant countries are The United States (USA),\nAustralia(AUS), Japan(JPN), China(CHN), and Great Britain(GBR). Does\nthis mean we must focus only on these five countries to answer the\nresearch questions? The answer is no. All countries are representative\nof our analysis, for hidden patterns might be found at the event/style\nlevel, which leads us to answer the first question. Are there any\npatterns or trends in the progression of swimming world records over\ntime? We can inspect the records that have been broken more frequently\nin certain events and during what periods.\n\nLet us create a bar graph that shows the number of records broken per\nyear and see if the swimming historical data reveals a trend between\n1980 and 2020.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# minimum and maximum years\nmin_year <- min(df_swim$event_year)\nmax_year <- max(df_swim$event_year)\n\ndf_swim %>%\n  ggplot(aes(x = event_year)) + \n  geom_bar(stat = 'count') +\n  scale_x_continuous(breaks = seq(min_year, max_year, by = 2 )) +\n  labs(title = \"Year records (1980 - 2022)\",\n       x = \"Years\", y =\"Number of records\") +\n  theme(axis.text.x = element_text(angle = 45))\n```\n\n::: {.cell-output-display}\n![](finalproject_KevinMartell_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\nThe data shows that over this range of years, swimmers of different\nages, nationalities, and categories have continuously been setting new\nworld records, suggesting that the number of swimming records has\nincreased as time progressed.\n\nThere are five crucial peaks (2008, 2009, 2016, 2019, and 2021) in the\nbar graph that we will analyze since the number of records increased\ncontinuously yearly.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# filter data by years of interest\npeaks_yrs <- df_swim %>%\n  filter(\n      df_swim$event_year == 2008 |\n      df_swim$event_year == 2009 |\n      df_swim$event_year == 2016 |\n      df_swim$event_year == 2019 |\n      df_swim$event_year == 2021 )\n\npeaks_yrs <- peaks_yrs %>%\n  mutate(event_year  = factor(event_year))\n```\n:::\n\n\nAnalyzing such years in the context of the length of race, we will see\nwhether there is a certain distance in which swimmers have set more new\nrecords compared to others' distances. For this graph, we do not\nconsider the nationality, gender, or age of the swimmer who set a record\nsince this is an analysis at the swimming-length level.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# extract the length of the races\nevent_descriptions <- peaks_yrs$`Event description`\nreg <- regexpr(\"\\\\d+\", event_descriptions)\npeaks_yrs$length_race <-regmatches(event_descriptions, reg)\n\n# create a histogram of the peak years\nggplot(peaks_yrs, aes(length_race, fill = event_year)) +\n  geom_histogram(stat = \"count\",position=\"dodge2\") +\n  theme(legend.position = \"top\") +\n  labs(x = \"Length of races in meters (m)\", \n       y = \"Number of broken records\", \n       title = \"Records by swimming length\") +\n  guides(fill = guide_legend(title = \"Year of observation\")) +\n  coord_flip()\n```\n\n::: {.cell-output-display}\n![](finalproject_KevinMartell_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n\nThen, let us analyze such years in the context of swimming events and\nsee whether there are certain swimming events in which swimmers have set\nmore new records than other events. Even though the names of the\nswimming event involve gender, they are officially unique swimming\nevents. For this graph, we do not consider the nationality, gender, or\nage of the swimmer who set a record since this is an analysis at the\nswimming-event level.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Create a bar graph of the filtered data\npeaks_yrs %>% \n  ggplot(aes(`Event description` )) +\n    geom_bar(aes(fill= event_year), \n             position = position_stack(reverse = TRUE)) +\n    theme(legend.position = \"top\") +\n    labs(x = \"Type of swimming event\", \n         y = \"Number of broken records\", \n         title = \"Broken records by swimming event\") +\n    guides(fill = guide_legend(title = \"Year of observation\")) +\n    coord_flip() \n```\n\n::: {.cell-output-display}\n![](finalproject_KevinMartell_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n\nThanks to this visualization, in general, swimmers are more likely to\nset new records more frequently in the following swimming events: Women\n100 Backstroke LCM Female, Men 100 Breaststroke LCM Male, and Men 100\nFreestyle LCM Male, for the proportions of new records increased year\nafter year during this periods. Likewise, based on the graph, the\nswimming strokes more likely to be broken are breaststroke, butterfly,\nand freestyle: the proportions are increasing yearly.\n\n*Moving forward to the second question, t*o investigate the relationship\nbetween age, gender, or nationality and their likelihood of breaking a\nworld record, we will use histograms for 1) swimmers; age at year\ncompetition, 2) swimmers' gender, and 3) swimmers' nationality.\n\nLet us plot the age histograms by age from the whole data set.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf_swim %>%\n  ggplot( aes(event_athle_age, center = event_athle_age), bins = 100 ) +\n  geom_histogram(binwidth = 1, \n                 fill = \"skyblue\", \n                 color = \"gray\",\n                 breaks = seq(5, 40, by = 1)) +\n  scale_x_continuous(breaks = seq(5, 40, by = 2),\n                     labels = seq(5, 40, by = 2)) +\n  labs(title = \"Age distribution at a year of competition (1980 - 2020)\",\n       x = \"Age\", \n       y =\"Number of swimmers\")\n```\n\n::: {.cell-output-display}\n![](finalproject_KevinMartell_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n\n\nWe observe that swimmers aged between 21 and 25 years old at the year of\nthe competition have set more records from 1980 to 2020. Physical\ndevelopment would be the most reasonable explanation. Younger swimmers\nmay have a greater potential for physical development, as their bodies\nare still growing and developing. This can give them an advantage in\nterms of strength, power, and flexibility, which can help them to swim\nfaster and break records.\n\nLet us plot a histograms of the age distributions by country.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf_swim %>%\n  ggplot(aes(event_athle_age)) +\n  geom_histogram(binwidth = 1, \n                 fill = \"skyblue\", \n                 color = \"gray\",\n                 show.legend = TRUE) +\n  xlim(10,40) +\n  facet_wrap(~df_swim$`Team Code`) +\n  labs(title = \"Age distribution by country\",\n       x = \"Age\", \n       y =\"Number of swimmers\")\n```\n\n::: {.cell-output-display}\n![](finalproject_KevinMartell_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n:::\n\n\nWe can see that The United States (USA), Australia(AUS), Japan(JPN),\nChina(CHN), Great Britain(GBR), Italy(ITA), and Russia(RUS) have the\nswimmers whose ages were between 21 and 25 at a year of competition,\nsuggesting that swimmers from these countries and between those ages are\nmore likely to set new world records in future swimming champions.\nGenetics and body type could one explanation. Certain countries may have\na higher prevalence of individuals with genetic traits that are\nbeneficial for swimming, such as a tall and lean body type or a high\npercentage of fast-twitch muscle fibers.\n\nLet us plot a third histogram disaggregated by gender.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf_swim %>%\n  ggplot( aes(event_athle_age)) +\n  geom_histogram(binwidth = 1, \n                 fill = \"skyblue\", \n                 color = \"gray\" ,\n                 breaks = seq(5, 40, by = 1)) +\n  scale_x_continuous(breaks = seq(5, 40, by = 2),\n                     labels = seq(5, 40, by = 2)) +\n  facet_wrap(~df_swim$Gender) +\n  labs(title = \"Age distribution by gender\",\n       x = \"Age\", \n       y =\"Number of swimmers\")\n```\n\n::: {.cell-output-display}\n![](finalproject_KevinMartell_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n:::\n\n\nThese histograms suggests that males between 21 and 25 years old have a\nhigher likelihood of setting new records compared to females swimmer.\nWhy is that? One factor could be physiology - men generally have more\nmuscle mass and larger body size than women, which can give them a\nphysical advantage in swimming. This can be particularly beneficial in\nevents that require power and strength, such as the sprint events.\nHowever, the gender gap in world record-breaking is narrowing. In recent\nyears, female swimmers have been breaking records with increasing\nfrequency, and the gap between male and female records is slowly\nclosing.\n\n*Have advancements in technology or changes in swimming equipment had an\nimpact on the frequency or magnitude of world record breaking? For\nexample, have swimsuits or other equipment innovations led to more world\nrecords being broken in recent years?*\n\nTo answer the last question regarding the advancements in\ntechnology or changes in swimming equipment that had an impact on the frequency or magnitude of world record-breaking, we will 1) use all the data set, 2) create eight year categories (10-15, 16-20, 21-25, 26-30, 31-35, 36-40, 41-45, and 46+), and 3) create a new column with the swimming style (freestyle, butterfly, backstroke, breaststroke, and medley). This will help us abstract the number of swimmers based on their ages for each swimming style and see which of them they have broken more records for a given year. We want to visualize jumps in the number of records per year. \n\n::: {.cell}\n\n```{.r .cell-code}\n# divide categories according to age\nbest_performace <- df_swim %>%\n  mutate(age_category = case_when(\n    event_athle_age > 10  & event_athle_age <= 15  ~ \"10-15\",\n    event_athle_age > 15  & event_athle_age <= 20  ~ \"16-20\",\n    event_athle_age > 20  & event_athle_age <= 25  ~ \"21-25\",\n    event_athle_age > 25  & event_athle_age <= 30  ~ \"26-30\",\n    event_athle_age > 30  & event_athle_age <= 35  ~ \"31-35\",\n    event_athle_age > 35  & event_athle_age <= 40  ~ \"36-40\",\n    event_athle_age > 40  & event_athle_age <= 45  ~ \"41-45\",\n    TRUE ~ \"+46\" ))\n\n# extract swimming style from Event description\nfor (i in 1:dim(peaks_yrs)[1]) {\n  best_performace$swim_style_category[i] <- strsplit(best_performace$`Event description`, \" \")[[i]][3]\n}\n```\n:::\n\n\nLet us plot the graph.\n\n::: {.cell}\n\n```{.r .cell-code}\n# Create a bar graph of the filtered data\nbest_performace %>% \n  ggplot(aes(x = event_year,\n             y = age_category,\n             color =  swim_style_category,\n             alpha = 0.3)) +\n  geom_count(aes(size = after_stat(prop), group = 1)) +\n  facet_wrap(~swim_style_category) +\n  scale_size_area(max_size = 8) +\n  labs(title = \"Records by year and swimimg category\",\n       x = \"Year\", \n       y =\"Age category\")\n```\n\n::: {.cell-output-display}\n![](finalproject_KevinMartell_files/figure-html/unnamed-chunk-16-1.png){width=672}\n:::\n:::\n\n\nAdvancements in technology and changes in swimming equipment have had a\nsignificant impact on the frequency and magnitude of world record\nbreaking in recent years. High-tech swimsuits were introduce in the early 2000s had a major impact on the number of world records being broken. we can observe that the proportions of world records started to increase from 2000's. These swimsuits were designed to reduce drag and improve buoyancy, which allowed swimmers to swim faster and more efficiently. The suits were so effective that they were eventually banned by the International Swimming Federation (FINA) in 2010.\n\n## Conclusion and Discussion {#conclusion}\n\nThis data analysis suggests that there are patterns or trends in the progression of swimming, such swimmers between 21 and 25 have a higher likelihood of breaking world records in Women\n100 Backstroke LCM Female, Men 100 Breaststroke LCM Male, and Men 100 Freestyle LCM Male. We also explored the relationship between a swimmer's age, gender, or nationality and their likelihood of breaking a world record. Finally, high-tech swimsuits have impacted the frequency or magnitude of world record-breaking starting in 2010. The top 200 world records allowed us to explore historical data, suggesting the findings we presented in this paper.\n\n## Bibliography\n\n    - For reference, you can check out [the source of the dataset](https://data.world/romanian-data/swimming-dataset-top-200-world-times)\n    - R as a programming language\n",
    "supporting": [
      "finalproject_KevinMartell_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}